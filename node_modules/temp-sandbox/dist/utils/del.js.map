{"version":3,"sources":["../../src/utils/del.ts"],"names":["del","patterns","options","removeTheseFiles","dryRun","map","file","removed","error","code","path","resolve","sync","DelSync"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;AAEA,eAAeA,GAAf,CACCC,QADD,EAECC,OAAgB,GAAG,EAFpB,EAGgC;AAC/B;AACA,MAAIC,gBAAgB,GAAG,MAAM,kBAAUF,QAAV,EAAoB,EAChD,GAAGC,OAD6C;AAEhDE,IAAAA,MAAM,EAAE;AAFwC,GAApB,CAA7B;AAKAD,EAAAA,gBAAgB,GAAGA,gBAAgB,CAACE,GAAjB,CAAsBC,IAAD,IAAkB;AACzD,WAAO,oBAAMA,IAAN,CAAP;AACA,GAFkB,CAAnB;;AAIA,MAAI;AACH,UAAMC,OAAO,GAAG,MAAM,kBAAUJ,gBAAV,EAA4BD,OAA5B,CAAtB;AAEA,WAAOK,OAAP;AACA,GAJD,CAIE,OAAOC,KAAP,EAAc;AACf;;;;;AAKA,QAAIA,KAAK,CAACC,IAAN,KAAe,QAAnB,EAA6B;AAC5B;AACA,YAAM,kBAAUN,gBAAV,EAA4BD,OAA5B,CAAN,CAF4B,CAI5B;;AACA,aAAOC,gBAAgB,CAACE,GAAjB,CAAsBC,IAAD,IAAkB;AAC7C,eAAOI,cAAKC,OAAL,CAAaL,IAAb,CAAP;AACA,OAFM,CAAP;AAGA;;AAED,UAAME,KAAN;AACA;AACD,C,CAED;;;AACAR,GAAG,CAACY,IAAJ,GAAWC,SAAX","sourcesContent":["import path from 'path';\nimport delActual, { sync as DelSync, Options } from 'del';\nimport slash from 'slash';\n\nasync function del(\n\tpatterns: string | readonly string[],\n\toptions: Options = {},\n): ReturnType<typeof delActual> {\n\t// workaround for https://github.com/sindresorhus/del/issues/68\n\tlet removeTheseFiles = await delActual(patterns, {\n\t\t...options,\n\t\tdryRun: true,\n\t});\n\n\tremoveTheseFiles = removeTheseFiles.map((file): string => {\n\t\treturn slash(file);\n\t});\n\n\ttry {\n\t\tconst removed = await delActual(removeTheseFiles, options);\n\n\t\treturn removed;\n\t} catch (error) {\n\t\t/**\n\t\t * Intermittently error code 'EINVAL' is being thrown here.\n\t\t * Would be great to find out why\n\t\t * Test will fail only if validating removed files.\n\t\t */\n\t\tif (error.code === 'EINVAL') {\n\t\t\t// when the EINVAL happens, the files are usually removed 90% of the time. Run delActual again to get the remaining 10%\n\t\t\tawait delActual(removeTheseFiles, options);\n\n\t\t\t// del returns absolute files with system's path.sep\n\t\t\treturn removeTheseFiles.map((file): string => {\n\t\t\t\treturn path.resolve(file);\n\t\t\t});\n\t\t}\n\n\t\tthrow error;\n\t}\n}\n\n// EINVAL does not happen async\ndel.sync = DelSync;\n\nexport { del };\n"],"file":"del.js"}